model:
  pretrained_name: "/llm_reco/dehua/model/Qwen2.5-VL-7B-Instruct"
  num_labels: 101  # Food101çš„ç±»åˆ«æ•°

# æŸå¤±å‡½æ•°é…ç½®
loss:
  type: "label_smoothing"  # é€‰é¡¹: cross_entropy, focal, label_smoothing, arcface, symmetric_ce
  smoothing: 0.1
  temperature: 1.0

# ç»Ÿä¸€é¢‘ç‡è®¾ç½®ï¼ˆæ¨èä¸”å”¯ä¸€æ”¯æŒçš„æ–¹å¼ï¼‰
monitor:
  freq:
    training_log_freq: 20      # è®­ç»ƒæŒ‡æ ‡è®°å½•é¢‘ç‡
    eval_log_freq: 1            # è¯„ä¼°æŒ‡æ ‡è®°å½•é¢‘ç‡ï¼ˆè·³è¿‡è¯„ä¼°æ—¶ä¸ä½¿ç”¨ï¼‰
    perf_log_freq: 50          # æ€§èƒ½æŒ‡æ ‡è®°å½•é¢‘ç‡
    gpu_log_freq: 50           # GPUç›‘æ§é¢‘ç‡
    flops_profile_freq: 50     # MFUè®¡ç®—é¢‘ç‡ (ä½¿ç”¨profiler)
    local_save_freq: 500       # æœ¬åœ°æ—¥å¿—ä¿å­˜é¢‘ç‡
    progress_update_freq: 50    # è¿›åº¦æ›´æ–°é¢‘ç‡

# å•æ•°æ®é›†é…ç½®
datasets:
  dataset_configs:
    food101:
      num_classes: 101
      description: "Food-101 dataset"
      eval_ratio: 1  # è·³è¿‡è¯„ä¼°æ—¶ä¸ä½¿ç”¨
  # å•æ•°æ®é›†ä¸éœ€è¦logits masking
  enable_logits_masking: false
  # å•æ•°æ®é›†ä¸éœ€è¦shuffle
  shuffle_datasets: false

data:
  # å•æ•°æ®é›†ä½¿ç”¨åŸå§‹æ ¼å¼
  train_jsonl: "/llm_reco/dehua/code/qwen_classify/data/dataset_food_label/food101_train.jsonl"
  val_jsonl: "/llm_reco/dehua/code/qwen_classify/data/dataset_food_label/food101_test.jsonl"

training:
  epochs: 5
  lr: 5e-6
  weight_decay: 0.01
  warmup_steps: 200
  output_dir: "/mmu_mllm_hdd_2/madehua/model/qwen_classify/food101_no_eval_save_all"
  logging_steps: 50
  save_steps: 200
  eval_steps: 200  # è™½ç„¶è®¾ç½®äº†ï¼Œä½†ç”±äºskip_evaluation=trueä¼šè¢«å¿½ç•¥
  save_hf_format: true
  save_deepspeed_format: false
  
  # ğŸ”¥ æ–°å¢åŠŸèƒ½ï¼šè·³è¿‡è¯„ä¼°å’Œä¿å­˜æ‰€æœ‰checkpoint
  skip_evaluation: true         # è·³è¿‡æ‰€æœ‰è¯„ä¼°ï¼Œåªè¿›è¡Œè®­ç»ƒ
  save_all_checkpoints: true    # ä¿å­˜æ‰€æœ‰checkpointï¼Œè€Œä¸æ˜¯åªä¿å­˜æœ€ä½³çš„
  
  # ä»¥ä¸‹é…ç½®åœ¨skip_evaluation=trueæ—¶ä¼šè¢«è‡ªåŠ¨ç¦ç”¨
  best_model_tracking:
    enabled: false              # å°†è¢«è‡ªåŠ¨è®¾ç½®ä¸ºfalse
    metric: "overall_accuracy"
    mode: "max"
    save_best_only: false       # å°†è¢«è‡ªåŠ¨è®¾ç½®ä¸ºfalse
  
  evaluation:
    partial_eval_during_training: false  # å°†è¢«è‡ªåŠ¨è®¾ç½®ä¸ºfalse
    full_eval_at_end: false             # å°†è¢«è‡ªåŠ¨è®¾ç½®ä¸ºfalse
    eval_best_model_only: false         # å°†è¢«è‡ªåŠ¨è®¾ç½®ä¸ºfalse

# å…¶ä»–é…ç½®
optimizer:
  type: "adamw"
  lr: 5e-6
  weight_decay: 0.01
  eps: 1e-8

lr_scheduler:
  type: "cosine"
  warmup_steps: 200
  min_lr_ratio: 0.01

deepspeed:
  config_path: "configs/ds_s2_as_8.json"

# å¦‚æœä¸æƒ³ä½¿ç”¨wandbè®°å½•ï¼Œå¯ä»¥ç¦ç”¨
wandb:
  enabled: true
  project: "qwen_classify_no_eval"
  name: "food101_no_eval_save_all"
  log_code: false
  log_dataset_metrics: false  # è·³è¿‡è¯„ä¼°æ—¶ä¸éœ€è¦æ•°æ®é›†æŒ‡æ ‡ 