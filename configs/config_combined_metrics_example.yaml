# 配置文件示例：确保training和eval指标都能正确显示
# 关键设置：eval_steps和logging_steps的关系

# 基础配置
output_dir: "./output/combined_metrics_test"
model_name: "Qwen/Qwen2.5-VL-7B-Instruct"
max_length: 512
num_epochs: 3

# 训练配置
training:
  num_epochs: 3
  evaluation:
    partial_eval_during_training: true
    full_eval_at_end: true
    eval_best_model_only: true
  best_model_tracking:
    enabled: true
    metric: "overall_accuracy"
    mode: "max"
    save_best_only: false

# 🔥 关键频率设置 - 确保training和eval指标都能显示
# 方案1：eval_steps = logging_steps (推荐)
eval_steps: 100        # 每100步评估一次
logging_steps: 100     # 每100步记录一次日志
save_steps: 500        # 每500步保存一次检查点

# 方案2：eval_steps是logging_steps的倍数
# eval_steps: 200        # 每200步评估一次
# logging_steps: 100     # 每100步记录一次日志
# save_steps: 500        # 每500步保存一次检查点

# 方案3：logging_steps是eval_steps的倍数
# eval_steps: 50         # 每50步评估一次
# logging_steps: 100     # 每100步记录一次日志
# save_steps: 500        # 每500步保存一次检查点

# 监控频率配置
monitor:
  freq:
    log_freq: 100           # 训练日志频率
    eval_log_freq: 100      # 评估日志频率
    perf_log_freq: 100      # 性能指标日志频率
    flops_profile_freq: 500 # MFU计算频率

# WandB配置
wandb:
  enabled: true
  project: "qwen_classify_combined_metrics"
  name: "test_combined_metrics"
  log_dataset_metrics: true

# 数据集配置
datasets:
  dataset_configs:
    food101:
      name: "food101"
      split: "test"
      max_samples: 1000
    imagenet:
      name: "imagenet-1k"
      split: "validation"
      max_samples: 1000

# DeepSpeed配置
deepspeed: "configs/ds_config.json"

# 其他配置
save_deepspeed_format: true
save_hf_format: true 